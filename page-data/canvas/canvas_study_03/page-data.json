{"componentChunkName":"component---src-templates-blog-post-js","path":"/canvas/canvas_study_03/","result":{"data":{"site":{"siteMetadata":{"title":"김테디 블로그","author":"[minsangkimme]","siteUrl":"https://github.com/minsangkimme/minsangkimme.github.io","comment":{"disqusShortName":"","utterances":"minsangkimme/minsangkimme.github.io"},"sponsor":{"buyMeACoffeeId":"minsangkimme"}}},"markdownRemark":{"id":"f3f9edeb-d04a-5679-a963-2dd041b19898","excerpt":"canvas Video 이미지는 load 이벤트 리스너를 사용했습니다.\n비디오는 canplaythrough 이벤트 리스너를 사용합니다.  는 비디오가 재생 준비가 되면 호출됩니다. render 콜백 함수를 보면 drawImage 메서드를 통해 비디오를 그리는 것을 확인할 수 있습니다. drawImage는 3가지를 그릴 수 있습니다. Image Video 다른 canvas에 그려지는 것 을 그릴 수 있다.   Video 위에 낙서하기   시간보다  현재 시간이 커진 경우 message…","html":"<h1 id=\"canvas-video\" style=\"position:relative;\"><a href=\"#canvas-video\" aria-label=\"canvas video permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>canvas Video</h1>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"> <span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">let</span> canplayState <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n ctx<span class=\"token punctuation\">.</span>textAlign <span class=\"token operator\">=</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">;</span>\n ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span><span class=\"token string\">'비디오 로딩 중..'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">const</span> videoElem <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.video'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n videoElem<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canplaythrough'</span><span class=\"token punctuation\">,</span> render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n     ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>videoElem<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span></code></pre></div>\n<p>이미지는 load 이벤트 리스너를 사용했습니다.\n비디오는 canplaythrough 이벤트 리스너를 사용합니다.</p>\n<p><code class=\"language-text\">videoElem.addEventListener('canplaythrough', render);</code> 는 비디오가 재생 준비가 되면 호출됩니다.</p>\n<p>render 콜백 함수를 보면 drawImage 메서드를 통해 비디오를 그리는 것을 확인할 수 있습니다.</p>\n<p>drawImage는 3가지를 그릴 수 있습니다.</p>\n<ol>\n<li>Image</li>\n<li>Video</li>\n<li>다른 canvas에 그려지는 것 을 그릴 수 있다.  </li>\n</ol>\n<hr>\n<h2 id=\"video-위에-낙서하기\" style=\"position:relative;\"><a href=\"#video-%EC%9C%84%EC%97%90-%EB%82%99%EC%84%9C%ED%95%98%EA%B8%B0\" aria-label=\"video 위에 낙서하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Video 위에 낙서하기</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token string\">'bold 50px serif'</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> videoElem <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.video'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nvideoElem<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canplaythrough'</span><span class=\"token punctuation\">,</span> render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n   <span class=\"token punctuation\">{</span>time<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> <span class=\"token string\">\"1 ㅋㅋ\"</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">{</span>time<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> <span class=\"token string\">\"2 ㅎㅎ\"</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">{</span>time<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> <span class=\"token string\">\"3 ㅊㅊ\"</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>videoElem<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> message<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>videoElem<span class=\"token punctuation\">.</span>currentTime <span class=\"token operator\">></span> messages<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span>messages<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">,</span> messages<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> messages<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 429px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.66666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAERUlEQVQ4y22U60+TZxjG339kyeaSzSw4p07HxqG2nFooh7b0SEsLpQVaoC1SChSKHMoQEAGRqtA58DA3TeYBFOsUpsFkC1+WmR3M2D7o5gfnjPs0EPjtgR1iNp8nd+48132/13vdV573lXhuraw8Y/mPZZaXV0T8k1f+d14Rsba6JmKV1Y14trr53G+PnyAtLi6SSCS4+/XdTdJ1sf+71tdfgL2g7+mTp0iPHj1iaWmJhw8fsra29m9x483ra+ubefMsas/X/2YV2LqY7C/Fj399jDQQ7SVY56fS4aSrrZMPRo8RP3yY+FiMqfEJZi5eYPHLL5gaGyNYW8dgfx+ziVkm43EO9w8we+kiD+4/4PbcAtOfXkCyFBSSlZqGOiMHp7kUe7GOqjILPk8lsSMxzk5NcnD4IO11HqqtVsqsFmLHjnJm8rTotzLYG+Xe99/x8/1fOBWfQPLYHXhsNlqam+k262l1lRI2F7Ffr+XjcBNHeiIMdHfiMxuIBOoot5g4OjrGt199Q9AbYGoizu35OX78YYmJkSGkxppaelpaGOobIGIr5XhXJzVmHaHyMgI2A+Ggj7EDPXR7vYSFymBNFW0NDSwkrtNW38i5k2f4XXj30727fHJyHMltK6FEk8/xkWG6w2EmhgepEkqdBp0Yv4j+znZOx0bpC/jpi7TREQwIOyo4MR6jNeintbGec+enWLg1zfTFj5AqzEb0qky8FaVUl5oYFiP6bCZCVS7a/TWEqp2MRjsY74pw/sMpouEQkRINI71tRCts+IuVxCMBzpwY4uwpobBUqNAo0nAYijAWKHHoC7DmKhhsDzPU1URHvZujA1HCLgeTI4cI+Svp1+YRa9tHc7EWf342xxoqaQq6GDwURbLrNRRnyDDnZFAkT6dEkJqy0nFZdLTUOehp8jDWt59md5kYtwavw0i9y05/dysVVgP63AxCIQ8+v4OuSCOSQa2kOFuOvVCFIUchQpBny3AbNdi1OfjK9HQJok5xlWrLDdQY8mhxmnnf76bWZkSTukdYpcPrNHGgvRmpWKVELUsRpHsx5WWgy0zFmJlGwG7Ba9VSK5pbKx2M5wqfNTl0K9M4YFZz1msn4LKhS9+D11JErVVHtKkeSZOdheKt7eTs3oFWnoL6vZ1o0pMp0+Ti1udRbc4n6LTiU2dTnp+FU5B6S9REG9xUmTSYMlLYZ9NQLZT3NgeQ9LlK0rclbRJqZMkod2+jIGU3FtVeHPmZVGhVQq1ReLxhxV5sYgp7oYJ9LhMunZoi0evIk1OlV9ER8CBlv5vMjpdfInnrFuTbt5Ly+ivIt70miJMoTN2JOVOoVSvQpe5CuSuJvHfeRCfbKTAZJSoZsjdeRZG0BYP8bVo85Ujz4te18YEnZqa5cXWGxOVL3Lgyzc3ZGT5PXOH2jVkW5q5z6/os87NXmLu2gV3jjsDuzH22id+8enkz35m/yZ+oKneMXpozWAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"canvas09\"\n        title=\"canvas09\"\n        src=\"/static/da6537ce7a58eaff8c0bdeaaf01dd04b/3d026/canvas09.png\"\n        srcset=\"/static/da6537ce7a58eaff8c0bdeaaf01dd04b/5a46d/canvas09.png 300w,\n/static/da6537ce7a58eaff8c0bdeaaf01dd04b/3d026/canvas09.png 429w\"\n        sizes=\"(max-width: 429px) 100vw, 429px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><code class=\"language-text\">messages[i].time</code> 시간보다 <code class=\"language-text\">videoElem.currentTime</code> 현재 시간이 커진 경우 message를 그립니다.</p>\n<h2 id=\"canvas-에서-video를-사용하는-이유\" style=\"position:relative;\"><a href=\"#canvas-%EC%97%90%EC%84%9C-video%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"canvas 에서 video를 사용하는 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>canvas 에서 video를 사용하는 이유</h2>\n<p>그래픽적으로 조작이 가능하기 때문입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"> <span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">const</span> videoElem <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.video'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n videoElem<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canplaythrough'</span><span class=\"token punctuation\">,</span> render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">const</span> btnsElem <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.btns'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">let</span> imageData<span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">const</span> particles <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">let</span> particle<span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">let</span> colorValue<span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">let</span> leng<span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n     ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>videoElem<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     imageData <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">getImageData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     leng <span class=\"token operator\">=</span> imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n     <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> leng<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>colorValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n             <span class=\"token keyword\">case</span> <span class=\"token string\">'red'</span><span class=\"token operator\">:</span>\n                imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n             <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n             <span class=\"token keyword\">case</span> <span class=\"token string\">'green'</span><span class=\"token operator\">:</span>\n                imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n             <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n             <span class=\"token keyword\">case</span> <span class=\"token string\">'blue'</span><span class=\"token operator\">:</span>\n                imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n             <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">}</span>\n     <span class=\"token punctuation\">}</span>\n\n     ctx<span class=\"token punctuation\">.</span><span class=\"token function\">putImageData</span><span class=\"token punctuation\">(</span>imageData<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n     btnsElem<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         colorValue <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data-color'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">ctx.getImageData</code>에 각 픽셀에  대한 색상정보를 가지고 있습니다.</p>\n<blockquote>\n<p><strong>getImageData</strong> 로 받아온 imageData 변수를 console에 찍어보면 data, width, height 등 있습니다. 여기서 data 가 중요한데  <strong>data 안에 픽셀 정보</strong>가 들어 있습니다.</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 447px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABkUlEQVQozz1Q2W6bUBDl/5/TxG1EvWMwYJaLMau5tgUkpkqlNnbrVc2XnBwcpQ+jmTtnuTOjXK9XXK4XHI9HxgHn8+l/tL1P7HD4i/1+j8vljP1uh0DEWEmJaJEiS3M0TYO3f29QTqcTyrImEMPz5lgw+57A1HCQZxnCeYI0SaFPLIxH2o1Xlg1UNUKWPSGJt9RUqKuf/PAPlN3uN4VbmqyxlluY0wKbzTO+qzkneMLM3iBJSsTRM1xnTayBrrecGt1egTyvOW2FKCrx+voLysvLj5vAdZcwZhKGKRGGBaZmAd9fwmHP91l7kpyPesbeIpQwLcmt2jeNlxVaL6WuK65FoR1D1TI89hfw3AyTSQghcuYItpVw8oQ5ojjDaBTSPLthQjBrESdcovVSVqsClhlBGwe800eMxz76fd5xGmA4DHjPOfoDQWFAEwFNm7MW6PUETDPAoO9zqwRSFlDSNCbJw8ODQcDB145Bsoe7O52CGb49muh27Rt2f29gOHDQ6ejUuPjCt6paDJt3dZGmCd4BN2q5tnr9cGYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"canvas10\"\n        title=\"canvas10\"\n        src=\"/static/b599dee439afed8aa3e4e918f30d850b/a2d48/canvas10.png\"\n        srcset=\"/static/b599dee439afed8aa3e4e918f30d850b/5a46d/canvas10.png 300w,\n/static/b599dee439afed8aa3e4e918f30d850b/a2d48/canvas10.png 447w\"\n        sizes=\"(max-width: 447px) 100vw, 447px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p> render 함수에 switch 에서 <code class=\"language-text\">i * 4</code>를 한 이유는 1픽셀당 4가지의 정보를 가지고 있기 때문에 <code class=\"language-text\">*4</code> 를 해준 것 입니다.</p>\n<p> 배열을 보면<code class=\"language-text\">[209, 234, 245, 255, ...]</code> 209는 R, 234는 G, 245는 B, 255는 투명도 이렇게 4가지 정보가 하나의 픽셀 정보라서 4를 곱해준 이유 입니다. </p>\n<p> 배열의 총길이가 96만개로 나오는데 이유는</p>\n<p> 현재 600*400 캔버스 사이즈는 24만 픽셀이고 * 4를 하면 96만개의 픽셀정보 배열을 나타냅니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"> leng <span class=\"token operator\">=</span> imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> leng<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>colorValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'red'</span><span class=\"token operator\">:</span>\n               imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'green'</span><span class=\"token operator\">:</span>\n               imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'blue'</span><span class=\"token operator\">:</span>\n               imageData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">*</span> <span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p> 이 부분에서 <code class=\"language-text\">leng</code>은 imageData.data.length / 4를 하니까 24만 값이 담깁니다.</p>\n<p> for문에서 24만번을 반복하는데 case에 따라\n해당 픽셀값을 하나하나 수정하는 작업을 의미합니다.</p>\n<p> +0, +1, +2 를 해준 이유는 각 RGB 에 맞는 index 값을 수정하기 위해 i*4 를 한 뒤  숫자들을 더해주면 해당 색을 수정할 수 있기 때문입니다.</p>\n<p> imageData가 수정이 완료 되었으면 수정한 것으로 변경 하기 위해선 putImageData를 이용해 변경하면 됩니다.</p>\n<blockquote>\n<p><code class=\"language-text\">ctx.putImageData(imageData, 0, 0);</code></p>\n</blockquote>","frontmatter":{"title":"[1분코딩] HTML5 Canvas 라이브 세션 #3","date":"October 08, 2021"}}},"pageContext":{"slug":"/canvas/canvas_study_03/","previous":{"fields":{"slug":"/canvas/canvas_study_02/"},"frontmatter":{"title":"[1분코딩] HTML5 Canvas 라이브 세션 #2"}},"next":{"fields":{"slug":"/etc/bm_font_apply/"},"frontmatter":{"title":"Gatsby 블로그 배민 폰트 적용하기"}}}},"staticQueryHashes":["2486386679","3128451518"]}